CREATE TABLE ProdutoOperacao(
Id INT NOT NULL AUTO_INCREMENT,
ProdutoId INT NOT NULL,
OperacaoId INT NOT NULL,
Quantidade INT NOT NULL,
Valor DOUBLE NOT NULL,
DataHoraOperacao Datetime NOT NULL,
	CONSTRAINT pk_ProdutoOperacao PRIMARY KEY(Id),
    CONSTRAINT fk_ProdutoOperacao_1 FOREIGN KEY(ProdutoId)
		REFERENCES Produto(Id),
	CONSTRAINT fk_ProdutoOperacao_2 FOREIGN KEY(OperacaoId)
		REFERENCES Operacao(Id)
);	

select * from ProdutoOperacao where datahoraoperacao >= '2019-09-01' order by datahoraoperacao;

INSERT INTO ProdutoOperacao(ProdutoId,OperacaoId,Quantidade,Valor,DataHoraOperacao)
VALUES
(600545, 1, 20, 18, '2020-09-01 10:00:00'),
(600545, 1, 40, 12, '2020-08-01 10:00:00'),
(600545, 1, 10, 20, '2020-07-01 10:00:00'),
(598123, 1, 20, 10, '2020-09-01 10:00:00'),
(598123, 1, 30, 30, '2019-08-01 10:00:00'),
(598128, 1, 40, 22, '2017-07-01 10:00:00'),
(600548, 1, 10, 21, '2018-10-01 10:00:00'),
(600548, 1, 20, 18, '2017-12-01 10:00:00'),
(600760, 1, 10, 15, '2020-01-01 10:00:00'),
(600760, 1, 20, 22, '2016-03-01 10:00:00'),
(600760, 1, 30, 25, '2017-07-01 10:00:00'),
(600759, 1, 40, 30, '2015-06-01 10:00:00'),
(600759, 1, 10, 20, '2018-07-01 10:00:00'),
(600757, 1, 20, 10, '2019-08-01 10:00:00'),
(600757, 1, 30, 15, '2020-04-01 10:00:00'),
(600662, 1, 30, 18, '2017-05-01 10:00:00'),
(600552, 1, 10, 16, '2016-06-01 10:00:00'),
(600552, 1, 20, 25, '2018-11-01 10:00:00'),
(600552, 1, 30, 20, '2019-10-01 10:00:00'),
(598130, 1, 40, 15, '2020-02-01 10:00:00'),
(598130, 1, 10, 30, '2018-09-01 10:00:00'),
(600553, 1, 20, 22, '2017-08-01 10:00:00'),
(600553, 1, 30, 20, '2016-07-01 10:00:00'),
(600555, 1, 40, 21, '2015-09-01 10:00:00'),
(600555, 1, 10, 22, '2019-08-01 10:00:00'),
(600555, 1, 30, 19, '2018-01-01 10:00:00'),
(600853, 1, 10, 20, '2020-03-01 10:00:00'),
(600853, 1, 20, 30, '2016-10-01 10:00:00'),
(600821, 1, 40, 20, '2017-12-01 10:00:00'),
(600820, 1, 10, 20, '2015-01-01 10:00:00'),
(600820, 1, 20, 20, '2016-10-01 10:00:00'),
(598390, 1, 30, 22, '2020-08-01 10:00:00'),
(598390, 1, 40, 25, '2018-05-01 10:00:00'),
(598390, 1, 20, 20, '2019-06-01 10:00:00'),
(597973, 1, 10, 15, '2019-07-01 10:00:00'),
(597973, 1, 30, 18, '2018-09-01 10:00:00'),
(600829, 1, 10, 20, '2020-12-01 10:00:00'),
(600829, 1, 40, 20, '2019-10-01 10:00:00'),
(600829, 1, 20, 22, '2017-11-01 10:00:00'),
(600833, 1, 40, 30, '2020-06-01 10:00:00'),
(600833, 1, 10, 35, '2019-04-01 10:00:00'),
(600663, 1, 30, 40, '2018-03-01 10:00:00'),
(598585, 1, 10, 22, '2017-08-01 10:00:00'),
(598585, 1, 20, 30, '2017-01-01 10:00:00'),
(598585, 1, 40, 30, '2016-01-01 10:00:00'),
(601310, 1, 20, 10, '2018-02-01 10:00:00'),
(601310, 1, 10, 10, '2020-03-01 10:00:00'),
(601139, 1, 10, 20, '2018-04-01 10:00:00'),
(601139, 1, 40, 22, '2019-05-01 10:00:00'),
(599047, 1, 30, 20, '2017-09-01 10:00:00'),
(599047, 1, 10, 20, '2019-11-01 10:00:00'),
(599047, 1, 20, 20, '2018-12-01 10:00:00'),
(599097, 1, 40, 30, '2019-10-01 10:00:00'),
(599097, 1, 20, 30, '2017-09-01 10:00:00'),
(599098, 1, 30, 30, '2019-10-01 10:00:00'),
(599098, 1, 10, 30, '2018-08-01 10:00:00'),
(599098, 1, 20, 30, '2019-03-01 10:00:00'),
(599098, 1, 40, 30, '2020-01-01 10:00:00'),
(601075, 1, 10, 20, '2017-05-01 10:00:00'),
(601075, 1, 20, 20, '2019-03-01 10:00:00'),
(600811, 1, 10, 20, '2020-04-01 10:00:00'),
(600811, 1, 40, 20, '2016-02-01 10:00:00'),
(600811, 1, 20, 20, '2020-03-01 10:00:00'),
(599449, 1, 10, 10, '2019-05-01 10:00:00'),
(599449, 1, 20, 10, '2017-08-01 10:00:00'),
(599453, 1, 30, 20, '2016-03-01 10:00:00'),
(599453, 1, 40, 20, '2015-04-01 10:00:00'),
(599469, 1, 10, 15, '2018-05-01 10:00:00'),
(599479, 1, 20, 20, '2019-09-01 10:00:00'),
(599479, 1, 10, 20, '2020-08-01 10:00:00'),
(599479, 1, 40, 20, '2016-04-01 10:00:00'),
(599479, 1, 30, 20, '2017-07-01 10:00:00');

INSERT INTO ProdutoOperacao(ProdutoId,OperacaoId,Quantidade,Valor,DataHoraOperacao)
VALUES
(600545, 2, 30, 20, '2020-09-01 10:00:00'),
(600545, 2, 22, 35, '2020-08-01 10:00:00'),
(600545, 2, 15, 15, '2020-07-01 10:00:00'),
(598123, 2, 35, 15, '2020-09-01 10:00:00'),
(598123, 2, 20, 35, '2019-08-01 10:00:00'),
(598128, 2, 40, 35, '2017-07-01 10:00:00'),
(600548, 2, 30, 22, '2018-10-01 10:00:00'),
(600548, 2, 15, 19, '2017-12-01 10:00:00'),
(600760, 2, 16, 16, '2020-01-01 10:00:00'),
(600760, 2, 18, 23, '2016-03-01 10:00:00'),
(600760, 2, 25, 18, '2017-07-01 10:00:00'),
(600759, 2, 16, 35, '2015-06-01 10:00:00'),
(600759, 2, 17, 21, '2018-07-01 10:00:00'),
(600757, 2, 22, 18, '2019-08-01 10:00:00'),
(600757, 2, 65, 19, '2020-04-01 10:00:00'),
(600662, 2, 08, 25, '2017-05-01 10:00:00'),
(600552, 2, 48, 19, '2016-06-01 10:00:00'),
(600552, 2, 22, 29, '2018-11-01 10:00:00'),
(600552, 2, 13, 24, '2019-10-01 10:00:00'),
(598130, 2, 35, 19, '2020-02-01 10:00:00'),
(598130, 2, 08, 38, '2018-09-01 10:00:00'),
(600553, 2, 19, 27, '2017-08-01 10:00:00'),
(600553, 2, 22, 23, '2016-07-01 10:00:00'),
(600555, 2, 13, 25, '2015-09-01 10:00:00'),
(600555, 2, 20, 19, '2019-08-01 10:00:00'),
(600555, 2, 25, 25, '2018-01-01 10:00:00'),
(600853, 2, 13, 13, '2020-03-01 10:00:00'),
(600853, 2, 12, 40, '2016-10-01 10:00:00'),
(600821, 2, 33, 23, '2017-12-01 10:00:00'),
(600820, 2, 15, 35, '2015-01-01 10:00:00'),
(600820, 2, 16, 23, '2016-10-01 10:00:00'),
(598390, 2, 08, 27, '2020-08-01 10:00:00'),
(598390, 2, 42, 28, '2018-05-01 10:00:00'),
(598390, 2, 13, 25, '2019-06-01 10:00:00'),
(597973, 2, 25, 18, '2019-07-01 10:00:00'),
(597973, 2, 13, 19, '2018-09-01 10:00:00'),
(600829, 2, 32, 25, '2020-12-01 10:00:00'),
(600829, 2, 12, 22, '2019-10-01 10:00:00'),
(600829, 2, 24, 27, '2017-11-01 10:00:00'),
(600833, 2, 35, 35, '2020-06-01 10:00:00'),
(600833, 2, 16, 39, '2019-04-01 10:00:00'),
(600663, 2, 22, 42, '2018-03-01 10:00:00'),
(598585, 2, 13, 23, '2017-08-01 10:00:00'),
(598585, 2, 25, 34, '2017-01-01 10:00:00'),
(598585, 2, 38, 32, '2016-01-01 10:00:00'),
(601310, 2, 13, 13, '2018-02-01 10:00:00'),
(601310, 2, 15, 14, '2020-03-01 10:00:00'),
(601139, 2, 22, 28, '2018-04-01 10:00:00'),
(601139, 2, 38, 29, '2019-05-01 10:00:00'),
(599047, 2, 35, 25, '2017-09-01 10:00:00'),
(599047, 2, 18, 25, '2019-11-01 10:00:00'),
(599047, 2, 28, 21, '2018-12-01 10:00:00'),
(599097, 2, 31, 39, '2019-10-01 10:00:00'),
(599097, 2, 18, 38, '2017-09-01 10:00:00'),
(599098, 2, 54, 37, '2019-10-01 10:00:00'),
(599098, 2, 14, 36, '2018-08-01 10:00:00'),
(599098, 2, 41, 35, '2019-03-01 10:00:00'),
(599098, 2, 98, 34, '2020-01-01 10:00:00'),
(601075, 2, 18, 23, '2017-05-01 10:00:00'),
(601075, 2, 45, 22, '2019-03-01 10:00:00'),
(600811, 2, 08, 21, '2020-04-01 10:00:00'),
(600811, 2, 42, 29, '2016-02-01 10:00:00'),
(600811, 2, 26, 25, '2020-03-01 10:00:00'),
(599449, 2, 17, 12, '2019-05-01 10:00:00'),
(599449, 2, 12, 16, '2017-08-01 10:00:00'),
(599453, 2, 33, 22, '2016-03-01 10:00:00'),
(599453, 2, 18, 29, '2015-04-01 10:00:00'),
(599469, 2, 18, 18, '2018-05-01 10:00:00'),
(599479, 2, 41, 23, '2019-09-01 10:00:00'),
(599479, 2, 08, 28, '2020-08-01 10:00:00'),
(599479, 2, 56, 29, '2016-04-01 10:00:00'),
(599479, 2, 22, 25, '2017-07-01 10:00:00');

INSERT INTO ProdutoOperacao(ProdutoId,OperacaoId,Quantidade,Valor,DataHoraOperacao)
VALUES
(600545, 1, 20, 15, '2020-09-05 10:00:00'), 
(598123, 1, 23, 15, '2020-09-05 10:00:00'), 
(598128, 1, 10, 15, '2020-09-05 10:00:00'), 
(600548, 1, 35, 15, '2020-09-05 10:00:00'), 
(600760, 1, 30, 15, '2020-09-05 10:00:00'), 
(600759, 1, 22, 15, '2020-09-05 10:00:00'), 
(600757, 1, 23, 15, '2020-09-05 10:00:00'), 
(600662, 1, 15, 15, '2020-09-05 10:00:00'), 
(600552, 1, 18, 15, '2020-09-05 10:00:00'), 
(598130, 1, 85, 15, '2020-09-05 10:00:00'), 
(600553, 1, 45, 15, '2020-09-05 10:00:00'), 
(600555, 1, 65, 15, '2020-09-05 10:00:00'), 
(600853, 1, 14, 15, '2020-09-05 10:00:00'), 
(600821, 1, 20, 15, '2020-09-05 10:00:00'), 
(600820, 1, 36, 15, '2020-09-05 10:00:00'), 
(598390, 1, 74, 15, '2020-09-05 10:00:00'), 
(597973, 1, 47, 15, '2020-09-05 10:00:00'), 
(600829, 1, 20, 15, '2020-09-05 10:00:00'), 
(600833, 1, 63, 15, '2020-09-05 10:00:00'), 
(600663, 1, 35, 15, '2020-09-05 10:00:00'), 
(598585, 1, 41, 15, '2020-09-05 10:00:00'), 
(601310, 1, 32, 15, '2020-09-05 10:00:00'), 
(601139, 1, 78, 15, '2020-09-05 10:00:00'), 
(599047, 1, 12, 15, '2020-09-05 10:00:00'), 
(599097, 1, 58, 15, '2020-09-05 10:00:00'), 
(599098, 1, 38, 15, '2020-09-05 10:00:00'), 
(601075, 1, 51, 15, '2020-09-05 10:00:00'), 
(600811, 1, 23, 15, '2020-09-05 10:00:00'), 
(599449, 1, 47, 15, '2020-09-05 10:00:00'), 
(599453, 1, 41, 15, '2020-09-05 10:00:00'), 
(599469, 1, 30, 15, '2020-09-05 10:00:00'), 
(599479, 1, 78, 15, '2020-09-05 10:00:00');

INSERT INTO ProdutoOperacao(ProdutoId,OperacaoId,Quantidade,Valor,DataHoraOperacao)
VALUES
(600545, 2, 18, 21, '2020-09-05 10:00:00'), 
(598123, 2, 20, 21, '2020-09-05 10:00:00'), 
(598128, 2, 12, 21, '2020-09-05 10:00:00'), 
(600548, 2, 41, 21, '2020-09-05 10:00:00'), 
(600760, 2, 28, 21, '2020-09-05 10:00:00'), 
(600759, 2, 21, 21, '2020-09-05 10:00:00'), 
(600757, 2, 19, 21, '2020-09-05 10:00:00'), 
(600662, 2, 08, 21, '2020-09-05 10:00:00'), 
(600552, 2, 09, 21, '2020-09-05 10:00:00'), 
(598130, 2, 68, 21, '2020-09-05 10:00:00'), 
(600553, 2, 35, 21, '2020-09-05 10:00:00'), 
(600555, 2, 59, 21, '2020-09-05 10:00:00'), 
(600853, 2, 09, 21, '2020-09-05 10:00:00'), 
(600821, 2, 25, 21, '2020-09-05 10:00:00'), 
(600820, 2, 34, 21, '2020-09-05 10:00:00'), 
(598390, 2, 71, 21, '2020-09-05 10:00:00'), 
(597973, 2, 40, 21, '2020-09-05 10:00:00'), 
(600829, 2, 10, 21, '2020-09-05 10:00:00'), 
(600833, 2, 49, 21, '2020-09-05 10:00:00'), 
(600663, 2, 39, 21, '2020-09-05 10:00:00'), 
(598585, 2, 40, 21, '2020-09-05 10:00:00'), 
(601310, 2, 27, 21, '2020-09-05 10:00:00'), 
(601139, 2, 56, 21, '2020-09-05 10:00:00'), 
(599047, 2, 05, 21, '2020-09-05 10:00:00'), 
(599097, 2, 22, 21, '2020-09-05 10:00:00'), 
(599098, 2, 26, 21, '2020-09-05 10:00:00'), 
(601075, 2, 06, 21, '2020-09-05 10:00:00'), 
(600811, 2, 22, 21, '2020-09-05 10:00:00'), 
(599449, 2, 69, 21, '2020-09-05 10:00:00'), 
(599453, 2, 40, 21, '2020-09-05 10:00:00'), 
(599469, 2, 25, 21, '2020-09-05 10:00:00'), 
(599479, 2, 65, 21, '2020-09-05 10:00:00');
